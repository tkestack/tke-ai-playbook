# vllm Benchmark Baseline

1 nodes, use 2 * 8 * H20 96GB

## Image

```Dockerfile
FROM vllm/vllm-openai:v0.9.0.1
RUN pip3 install pyarrow pandas
```

## Command
```bash
vllm serve /data/models/deepseek-ai/DeepSeek-R1 \
  --served-model-name deepseek-ai/DeepSeek-R1 \
  --block-size 128 \
  --max-model-len 4096 \
  --max-num-batched-tokens 4096 \
  --no-enable-prefix-caching \
  --enable-chunked-prefill \
  --compilation-config '{"cudagraph_capture_sizes": [1, 2, 4, 8, 16, 24, 32, 40, 48, 56, 64, 72, 80, 88, 96, 104, 112, 120, 128, 136, 144, 152, 160, 168, 176, 184, 192, 200, 208, 216, 224, 232, 240, 248, 256]}' \
  -tp 16 \
  --disable-log-requests \
  --enable-reasoning \
  --reasoning-parser deepseek_r1
```

## Benchmark Result (ISL:OSL=3000:150)
| Concurrency | Reqeuest Throughput (req/s) | Output Token Throughput (tok/s) | Mean E2E Lantency (ms)  | P99 E2E Lantency (ms) | Mean TTFT (ms) | P99 TTFT (ms) | Mean TPOT (ms) | P99 TPOT (ms) |
|:-----------:|:--------------------------:|:-------------------------------:|:-----------------------:|:---------------------:|:--------------:|:-------------:|:-------------:|:------------:|
| 1 | 0.21 | 31.28 | 4794.41 | 4841.15 | 315.73 | 318.74 | 30.06 | 30.39 |
| 2 | 0.35 | 52.1 | 5756.44 | 5870.18 | 459.21 | 612.92 | 35.55 | 37.18 |
| 4 | 0.61 | 91.37 | 6561.53 | 7169.04 | 561.26 | 1171.5 | 40.27 | 45.18 |
| 8 | 1 | 150.35 | 7968.12 | 9226.66 | 675.11 | 2264.11 | 48.95 | 51.44 |
| 16 | 1.45 | 217.66 | 10997.11 | 14324.16 | 875.6 | 4363.43 | 67.93 | 71.48 |
| 32 | 1.94 | 290.69 | 16448.69 | 23940.38 | 1271.29 | 8635.51 | 101.86 | 107.46 |
| 64 | 2.39 | 358.77 | 26629.59 | 42937.18 | 1872.85 | 17588.34 | 166.15 | 175.1 |
| 128 | 2.77 | 416.2 | 45830.93 | 79375.69 | 2976.7 | 35364.6 | 287.61 | 302.65 |

## Benchmark Result (ISL:OSL=1000:1000)
| Concurrency | Reqeuest Throughput (req/s) | Output Token Throughput (tok/s) | Mean E2E Lantency (ms)  | P99 E2E Lantency (ms) | Mean TTFT (ms) | P99 TTFT (ms) | Mean TPOT (ms) | P99 TPOT (ms) |
|:-----------:|:--------------------------:|:-------------------------------:|:-----------------------:|:---------------------:|:--------------:|:-------------:|:-------------:|:------------:|
| 1 | 0.03 | 33.32 | 30010.56 | 30202.48 | 158.64 | 167.93 | 29.88 | 30.07 |
| 2 | 0.06 | 57.96 | 34507.17 | 34743.53 | 233.92 | 305.74 | 34.31 | 34.59 |
| 4 | 0.11 | 110 | 36362.91 | 37012.77 | 370.24 | 453.67 | 36.03 | 36.76 |
| 8 | 0.2 | 204.05 | 39201.31 | 39719.73 | 486.31 | 846.82 | 38.75 | 39.37 |
| 16 | 0.35 | 352.11 | 45430.89 | 46466 | 615.43 | 1620.85 | 44.86 | 45.54 |
| 32 | 0.59 | 593.36 | 53908.9 | 56004.3 | 788.2 | 3114.6 | 53.17 | 54.67 |
| 64 | 0.93 | 932.26 | 68607.6 | 73112.96 | 1035.6 | 5904.52 | 67.64 | 68.83 |
| 128 | 1.44 | 1441.79 | 88679.14 | 98840.42 | 1426 | 11664.79 | 87.34 | 89.41 |

## Benchmark Result (ISL:OSL=500:1000)
| Concurrency | Reqeuest Throughput (req/s) | Output Token Throughput (tok/s) | Mean E2E Lantency (ms)  | P99 E2E Lantency (ms) | Mean TTFT (ms) | P99 TTFT (ms) | Mean TPOT (ms) | P99 TPOT (ms) |
|:-----------:|:--------------------------:|:-------------------------------:|:-----------------------:|:---------------------:|:--------------:|:-------------:|:-------------:|:------------:|
| 1 | 0.03 | 33.3 | 30031.68 | 30295.86 | 151.6 | 158.35 | 29.91 | 30.18 |
| 2 | 0.06 | 58.08 | 34431.96 | 34660.79 | 239.67 | 462.21 | 34.23 | 34.52 |
| 4 | 0.11 | 111.58 | 35846.46 | 36235.7 | 235.6 | 314.28 | 35.65 | 36.09 |
| 8 | 0.21 | 207.91 | 38476.3 | 39121.09 | 370.98 | 470.8 | 38.14 | 38.98 |
| 16 | 0.36 | 363.93 | 43958.6 | 44262.81 | 550.2 | 886.11 | 43.45 | 43.9 |
| 32 | 0.62 | 620.9 | 51526.32 | 52619.08 | 644.86 | 1675 | 50.93 | 52.19 |
| 64 | 1.01 | 1008.83 | 63417.48 | 65812.21 | 818.42 | 3342.4 | 62.66 | 63.16 |
| 128 | 1.62 | 1620.67 | 78928.23 | 83811.97 | 1052.66 | 6221.44 | 77.95 | 80.24 |